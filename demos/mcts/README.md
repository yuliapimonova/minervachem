# Traversing Chemical Space of Ligands with Monte Carlo Tree Search

## Problem & Motivation
Chemists & chemical engineers developing novel reaction processes or therapeutics are often encumbered by selecting and/or designing the appropriate molecular compound for their use-case.

This is largely due to a combinatorially vast chemical space, i.e. all the possible chemical combinations for molecular compounds. The majority of these combinations are theoretical and unexplored. There is therefore a **need for an efficient and targeted way for searching through chemical space for molecular compounds with user-specified properties for practical applications.**

## Approach
<img src="MCTS%20Process%20Flow%20Diagram.png" width="500"/>

We propose a machine learning framework using Monte Carlo Tree Search (MCTS) as a powerful tool for probing chemical space. Our framework takes in user inputs that define the parameters of the search and the desired molecules.

For example, users can set the pool of possible elements, bond types, and molecule branching as SMILES symbols from which MCTS will construct compounds. Users can also set the size of the compounds in atoms.

Most notably, users can set the desired chemical property and target value for optimization, e.g. “for my use case, I am interested in compounds with a logP solubility value of 1.35 in water/octanol”.

In addition, the behavior of the search can be tuned by setting the tree search parameters, such as the beam size for the number of top candidates to output, the depth of the search, and whether to favor exploration vs. exploitation of tree nodes.

The MCTS framework is thus able produce batches of theoretical compounds that meet user input requirements.


## Demo Notebooks
These notebooks demonstrate how MCTS can be used for molecular generation in various use-cases:
1. ```1_MCTS_with_RDKit.ipynb``` This notebook demonstrates how to manipulate MCTS search parameters to generate molecules for a simple use-case with RDKit.
2. ```2_MCTS_with_MinervaChem.ipynb``` This notebook demonstrates how to manipulate MCTS search parameters to generate molecules wtih a more sophisticated chemical evaluator, MinervaChem.
3. ```3_MCTS_experiments.ipynb``` This notebook explores some of the non-fully expanded molecules generated by MCTS in the RDKit solubility use-case.

## References
1. Browne, C. B., Powley, E., Whitehouse, D., Lucas, S. M., Cowling, P. I., Rohlfshagen, P., ... & Colton, S. (2012). A survey of monte carlo tree search methods. IEEE Transactions on Computational Intelligence and AI in games, 4(1), 1-43.
2. Świechowski, M., Godlewski, K., Sawicki, B., & Mańdziuk, J. (2023). Monte Carlo tree search: A review of recent modifications and applications. Artificial Intelligence Review, 56(3), 2497-2562.
3. Jensen, J. H. (2019). A graph-based genetic algorithm and generative model/Monte Carlo tree search for the exploration of chemical space. Chemical science, 10(12), 3567-3572.
4. Iwata, H., Nakai, T., Koyama, T., Matsumoto, S., Kojima, R., & Okuno, Y. (2023). VGAE-MCTS: A new molecular generative model combining the variational graph Auto-Encoder and monte carlo tree search. Journal of Chemical Information and Modeling, 63(23), 7392-7400.
5. Yang, X., Zhang, J., Yoshizoe, K., Terayama, K., & Tsuda, K. (2017). ChemTS: an efficient python library for de novo molecular generation. Science and technology of advanced materials, 18(1), 972-976.
6. Yang, X., Aasawat, T. K., & Yoshizoe, K. (2020). Practical massively parallel monte-carlo tree search applied to molecular design. arXiv preprint arXiv:2006.10504.
7. Tynes, M., Taylor, M. G., Janssen, J., Burrill, D. J., Perez, D., Yang, P., & Lubbers, N. (2024). Linear Graphlet Models for Accurate and Interpretable Cheminformatics.
8. Kajita, S., Kinjo, T., & Nishi, T. (2020). Autonomous molecular design by Monte-Carlo tree search and rapid evaluations using molecular dynamics simulations. Communications Physics, 3(1), 77.
9. Ross, J., Belgodere, B., Chenthamarakshan, V., Padhi, I., Mroueh, Y., & Das, P. (2022). Large-scale chemical language representations capture molecular structure and properties. Nature Machine Intelligence, 4(12), 1256-1264.
